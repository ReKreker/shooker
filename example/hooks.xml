<?xml version="1.0" encoding="UTF-8"?>
<shook>
    <compiler>/usr/bin/gcc</compiler> <!-- tested only with gcc-like compilers -->
    <lib_hook path="libtest.so">
        <!-- 1. can include syscall's lib that inlined in asm -->
        <!-- 2. can include it own lib's funcs and imports  -->
        <include>
            <func proto="int FUNC(char *, ...)" kind="import">printf</func>  <!-- get import from injected lib -->
            <!-- <func proto="void (*)(int)" kind="symbol">kek</func> -->    <!-- get symbol from injected lib -->
            <!-- <lib kind="system">some_lib.h</lib> -->                     <!-- transform to #include <some_lib.h> -->
            <!-- <lib kind="local">some_lib.h</lib> -->                      <!-- transform to #include "some_lib.h" -->
        </include>
        <hook name="add_n_print">
            <!-- have to use _s() for strings to avoid broken xref -->
            <patch proto="void FUNC(int arg1, int arg2)">
                printf(_s("lolkek"));
            </patch>
        </hook>
    </lib_hook>
</shook>